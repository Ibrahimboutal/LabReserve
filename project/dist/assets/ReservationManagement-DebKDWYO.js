import{X as Et,r as l,s as C,E as d,H as oe,J as de,j as e,C as ce,A as Bt,B as a,T as s,K as $t,L as he,O as Ut,a as m,N as He,P as v,k as Ye,n as Je,o as Ke,G as p,F as q,I as W,S as F,M as h,b as Xe,c as Ze,d as et,e as I,f as u,g as tt,Q as b,v as st,w as nt,Y as rt,Z as at,_ as it,R as Mt,U as Nt,V as Vt,W as Ot,p as N,t as V,$ as z,a0 as lt,D as ue,h as xe,i as je,l as me,y as Qt,a1 as Gt}from"./index-z-43rxTh.js";import{i as pe}from"./isTomorrow-C5dBabq1.js";import{P as ot}from"./Pagination-CFTubQZq.js";import{D as dt}from"./DialogContentText-DCVk7Q-l.js";import{a as ct,i as ge}from"./isToday-CCB4hpkQ.js";import"./LastPage-9l3JZRRp.js";function Ht(g){const w=Et(g);return w.setHours(23,59,59,999),w}function fe(g){const{children:w,value:S,index:D,...f}=g;return e.jsx("div",{role:"tabpanel",hidden:S!==D,id:`reservation-tabpanel-${D}`,"aria-labelledby":`reservation-tab-${D}`,...f,children:S===D&&e.jsx(a,{sx:{pt:3},children:w})})}function ns(){const[g,w]=l.useState([]),[S,D]=l.useState([]),[f,Se]=l.useState([]),[O,_e]=l.useState([]),[ke,be]=l.useState(!0),[Re,E]=l.useState(null),[Q,Le]=l.useState(""),[G,Pe]=l.useState(""),[H,Ae]=l.useState(""),[Y,Te]=l.useState(""),[J,qe]=l.useState(""),[K,We]=l.useState(""),[B,X]=l.useState(""),[ye,ht]=l.useState(!1),[ve,ut]=l.useState(!1),[xt,_]=l.useState(!1),[jt,Z]=l.useState(!1),[c,Ce]=l.useState(null),[x,we]=l.useState(null),[mt,ee]=l.useState(!1),[pt,te]=l.useState(!1),[k,se]=l.useState(null),[R,ne]=l.useState(null),[Fe,Ie]=l.useState(1),[ze,Ee]=l.useState(1),[$,gt]=l.useState(0),[U,ft]=l.useState([]),[re,Be]=l.useState(!1),[ae,$e]=l.useState(!1),[Yt,bt]=l.useState([]),L=10;l.useEffect(()=>{yt(),vt(),Ct()},[]),l.useEffect(()=>{Dt(),St(),wt()},[f,g,Q,H,J,B,K,Y,G]);const yt=async()=>{try{be(!0);const{data:t,error:n}=await C.from("reservations").select(`
          *,
          equipment (
            id,
            name,
            category,
            status,
            lab_id,
            manufacturer,
            model,
            image_url
          ),
          users (
            id,
            email,
            department,
            role
          )
        `).order("created_at",{ascending:!1});if(n)throw n;w(t),D(t)}catch(t){E(t.message)}finally{be(!1)}},vt=async()=>{try{const{data:t,error:n}=await C.from("lab_reservations").select(`*,
          lab (
            id,
            name,
            location,
            status,
            image_url
            ),
          users (
            id,
            email,
            department,
            role
          ) `).order("created_at",{ascending:!1});if(n)throw n;const r=t.map(y=>y.lab_id),{data:j,error:i}=await C.from("lab").select("*").in("id",r);if(i)throw i;const o=t.map(y=>y.user_id),{data:De,error:M}=await C.from("users").select("*").in("id",o);if(M)throw M;const le=t.map(y=>({...y,lab:j.find(T=>T.id===y.lab_id),user:De.find(T=>T.id===y.user_id)}));Se(le),_e(le)}catch(t){E(t.message)}finally{be(!1)}},Ct=async()=>{try{const{data:t,error:n}=await C.from("lab").select("*").order("name");if(n)throw n;ft(t)}catch(t){console.error("Error fetching labs:",t)}},wt=async()=>{try{const{data:t,error:n}=await C.from("users").select("*").order("created_at",{ascending:!1});if(n)throw n;bt(t||[])}catch(t){E(t.message)}},Ue=async(t,n,r,j,i)=>{try{const{error:o}=await C.from("notifications").insert([{id:crypto.randomUUID(),user_id:t,created_by:n,title:r,message:j,type:i,read:!1,created_at:new Date().toISOString()}]);if(o)throw o}catch(o){console.error("Error sending notification to user:",o.message)}},Dt=()=>{let t=[...g];if(Q){const n=Q.toLowerCase();t=t.filter(r=>r.equipment?.name.toLowerCase().includes(n)||r.users?.email.toLowerCase().includes(n)||r.purpose?.toLowerCase().includes(n)||r.equipment?.category.toLowerCase().includes(n)||r.quantity.toString().includes(n))}if(H&&(t=t.filter(n=>n.status===H)),B&&(t=t.filter(n=>n.equipment_id===B)),J){const n=new Date;n.setHours(0,0,0,0);const r=new Date(n);switch(r.setDate(r.getDate()+1),J){case"today":t=t.filter(i=>{const o=d(i.start_time);return ge(o)});break;case"tomorrow":t=t.filter(i=>{const o=d(i.start_time);return pe(o)});break;case"upcoming":t=t.filter(i=>{const o=d(i.start_time);return oe(o,n)});break;case"past":t=t.filter(i=>{const o=d(i.end_time);return de(o,n)});break;case"thisWeek":const j=ct(n,7);t=t.filter(i=>{const o=d(i.start_time);return oe(o,n)&&de(o,j)});break}}D(t),Ie(1)},St=()=>{let t=[...f];if(G){const n=G.toLowerCase();t=t.filter(r=>r.lab?.name.toLowerCase().includes(n)||r.users?.email.toLowerCase().includes(n)||r.purpose?.toLowerCase().includes(n)||r.attendees?.toString().includes(n))}if(Y&&(t=t.filter(n=>n.status===Y)),K){const n=new Date;n.setHours(0,0,0,0);const r=new Date(n);switch(r.setDate(r.getDate()+1),K){case"today":t=t.filter(i=>{const o=d(i.start_time);return ge(o)});break;case"tomorrow":t=t.filter(i=>{const o=d(i.start_time);return pe(o)});break;case"upcoming":t=t.filter(i=>{const o=d(i.start_time);return oe(o,n)});break;case"past":t=t.filter(i=>{const o=d(i.end_time);return de(o,n)});break;case"thisWeek":const j=ct(n,7);t=t.filter(i=>{const o=d(i.start_time);return oe(o,n)&&de(o,j)});break}}_e(t),Ee(1)},_t=async(t,n)=>{try{Be(!0);const{error:r}=await C.from("reservations").update({status:n,updated_at:new Date().toISOString()}).eq("id",t);if(r)throw r;w(j=>j.map(i=>i.id===t?{...i,status:n,updated_at:new Date().toISOString()}:i)),ee(!1),_(!1),se(null),await Ue(c.user_id,"System",`Reservation ${n}`,`Your reservation for ${c.equipment.name} has been ${n}.`,"reservation")}catch(r){console.error("Error updating reservation:",r),E(r.message)}finally{Be(!1)}},kt=async(t,n)=>{try{$e(!0);const{error:r}=await C.from("lab_reservations").update({status:n}).eq("id",t);if(r)throw r;Se(j=>j.map(i=>i.id===t?{...i,status:n}:i)),te(!1),Z(!1),ne(null),await Ue(x.user_id,"System",`Lab Reservation ${n}`,`Your lab reservation for ${x.lab.name} has been ${n}.`,"lab_reservation")}catch(r){console.error("Error updating lab reservation:",r),E(r.message)}finally{$e(!1)}},Rt=t=>{Ce(t),_(!0)},Lt=t=>{we(t),Z(!0)},P=(t,n)=>{Ce(t),se(n),ee(!0)},A=(t,n)=>{we(t),ne(n),te(!0)},ie=t=>{let n="default";switch(t){case"pending":n="warning";break;case"approved":n="success";break;case"denied":n="error";break;case"cancelled":n="default";break;case"completed":n="info";break}return e.jsx(Qt,{label:t,color:n,size:"small"})},Pt=(t,n)=>{Ie(n)},At=(t,n)=>{Ee(n)},Tt=(t,n)=>{gt(n)},qt=[...S.map(t=>({id:t.id,title:`${t.equipment?.name} (${t.users?.email.split("@")[0]})`,start:t.start_time,end:t.end_time,extendedProps:{type:"equipment",status:t.status,equipment:t.equipment,user:t.users,purpose:t.purpose},backgroundColor:t.status==="approved"?"#4caf50":t.status==="pending"?"#ff9800":t.status==="denied"?"#e53935":t.status==="cancelled"?"#9e9e9e":t.status==="completed"?"#1e88e5":"#ff9800",borderColor:t.status==="approved"?"#4caf50":t.status==="pending"?"#ff9800":t.status==="denied"?"#e53935":t.status==="cancelled"?"#9e9e9e":t.status==="completed"?"#1e88e5":"#ff9800"})),...O.map(t=>({id:t.id,title:`${t.lab?.name} (${t.user?.email.split("@")[0]})`,start:t.start_time,end:t.end_time,extendedProps:{type:"lab",status:t.status,lab:t.lab,user:t.user,purpose:t.purpose},backgroundColor:t.status==="approved"?"#4caf50":t.status==="pending"?"#ff9800":t.status==="denied"?"#e53935":t.status==="cancelled"?"#9e9e9e":t.status==="completed"?"#1e88e5":"#ff9800",borderColor:t.status==="approved"?"#2e7d32":t.status==="pending"?"#e65100":t.status==="denied"?"#c62828":t.status==="cancelled"?"#616161":t.status==="completed"?"#1976d2":"#e65100"}))],Wt=t=>{const{extendedProps:n}=t.event;if(n.type==="equipment"){const r=g.find(j=>j.id===t.event.id);r&&(Ce(r),_(!0))}else if(n.type==="lab"){const r=f.find(j=>j.id===t.event.id);r&&(we(r),Z(!0))}};if(ke&&g.length===0)return e.jsx(ce,{});if(ke&&f.length===0)return e.jsx(ce,{});if(Re)return e.jsx(Bt,{severity:"error",children:Re});const Me=(Fe-1)*L,Ft=Me+L,Ne=S.slice(Me,Ft),Ve=Math.ceil(S.length/L),Oe=(ze-1)*L,It=Oe+L,Qe=O.slice(Oe,It),Ge=Math.ceil(O.length/L),zt=((t,n)=>{const r=new Date,j=Gt(r),i=Ht(r);return t.map(o=>{const De=String(o.id),M=n.filter(y=>String(y.lab_id)===De&&y.status==="approved"),le=M.filter(y=>{const T=d(y.start_time);return T>=j&&T<=i});return{...o,activeReservations:M.length,todaysReservations:le.length}})})(U,f);return e.jsxs(a,{children:[e.jsx(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:e.jsx(s,{variant:"h6",fontWeight:"bold",children:"Reservation Management"})}),e.jsx(a,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs($t,{value:$,onChange:Tt,"aria-label":"reservation view tabs",children:[e.jsx(he,{label:"Equipment Reservation"}),e.jsx(he,{label:"Lab Reservations"}),e.jsx(he,{label:"Calendar View",icon:e.jsx(Ut,{}),iconPosition:"start"}),e.jsx(he,{label:"Dashboard"})]})}),e.jsxs(fe,{value:$,index:0,children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(s,{variant:"h6",fontWeight:"bold",children:"Equipment Reservation Management"}),e.jsx(m,{variant:"outlined",startIcon:e.jsx(He,{}),onClick:()=>ht(!ye),children:"Filters"})]}),e.jsxs(v,{sx:{p:2,mb:3},children:[e.jsx(Ye,{placeholder:"Search by equipment, user, quantity, or purpose...",variant:"outlined",size:"small",fullWidth:!0,value:Q,onChange:t=>Le(t.target.value),InputProps:{startAdornment:e.jsx(Je,{position:"start",children:e.jsx(Ke,{})})},sx:{mb:ye?2:0}}),ye&&e.jsxs(a,{sx:{mt:2},children:[e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(q,{size:"small",fullWidth:!0,children:[e.jsx(W,{children:"Status"}),e.jsxs(F,{value:H,label:"Status",onChange:t=>Ae(t.target.value),children:[e.jsx(h,{value:"",children:"All Statuses"}),e.jsx(h,{value:"pending",children:"Pending"}),e.jsx(h,{value:"approved",children:"Approved"}),e.jsx(h,{value:"denied",children:"Denied"}),e.jsx(h,{value:"cancelled",children:"Cancelled"}),e.jsx(h,{value:"completed",children:"Completed"})]})]})}),e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(q,{size:"small",fullWidth:!0,children:[e.jsx(W,{children:"Date"}),e.jsxs(F,{value:J,label:"Date",onChange:t=>qe(t.target.value),children:[e.jsx(h,{value:"",children:"All Dates"}),e.jsx(h,{value:"today",children:"Today"}),e.jsx(h,{value:"tomorrow",children:"Tomorrow"}),e.jsx(h,{value:"thisWeek",children:"This Week"}),e.jsx(h,{value:"upcoming",children:"All Upcoming"}),e.jsx(h,{value:"past",children:"Past"})]})]})}),e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(q,{size:"small",fullWidth:!0,children:[e.jsx(W,{children:"Laboratory"}),e.jsxs(F,{value:B,label:"Laboratory",onChange:t=>X(t.target.value),children:[e.jsx(h,{value:"",children:"All Laboratories"}),U.map(t=>e.jsx(h,{value:t.id,children:t.name},t.id))]})]})})]}),e.jsx(a,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:e.jsx(m,{variant:"text",color:"secondary",size:"small",onClick:()=>{Le(""),Ae(""),qe(""),X("")},children:"Clear Filters"})})]})]}),e.jsx(Xe,{component:v,children:e.jsxs(Ze,{children:[e.jsx(et,{children:e.jsxs(I,{children:[e.jsx(u,{children:"User"}),e.jsx(u,{children:"Equipment"}),e.jsx(u,{children:"Start Time"}),e.jsx(u,{children:"End Time"}),e.jsx(u,{children:"Quantity"}),e.jsx(u,{children:"Status"}),e.jsx(u,{children:"Actions"})]})}),e.jsx(tt,{children:Ne.length>0?Ne.map(t=>e.jsxs(I,{children:[e.jsx(u,{children:e.jsxs(a,{children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:t.users?.email.split("@")[0]}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[t.users?.department," • ",t.users?.role]})]})}),e.jsx(u,{children:e.jsxs(a,{children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:t.equipment?.name}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[t.equipment?.category," • ",t.labs?.name]})]})}),e.jsx(u,{children:b(d(t.start_time),"PPpp")}),e.jsx(u,{children:b(d(t.end_time),"PPpp")}),e.jsx(u,{children:t.quantity}),e.jsx(u,{children:ie(t.status)}),e.jsx(u,{children:e.jsxs(a,{sx:{display:"flex",gap:1},children:[e.jsx(st,{title:"View Details",children:e.jsx(nt,{size:"small",onClick:()=>Rt(t),children:e.jsx(rt,{fontSize:"small"})})}),t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{size:"small",color:"success",variant:"outlined",onClick:()=>P(t,"approve"),startIcon:e.jsx(at,{}),children:"Approve"}),e.jsx(m,{size:"small",color:"error",variant:"outlined",onClick:()=>P(t,"deny"),startIcon:e.jsx(it,{}),children:"Deny"})]})]})})]},t.id)):e.jsx(I,{children:e.jsxs(u,{colSpan:6,align:"center",children:[e.jsx(s,{variant:"subtitle1",sx:{py:2},children:"No reservations found"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Try adjusting your search or filter criteria"})]})})})]})}),Ve>1&&e.jsx(a,{sx:{display:"flex",justifyContent:"center",mt:3},children:e.jsx(ot,{count:Ve,page:Fe,onChange:Pt,color:"primary"})})]}),e.jsxs(fe,{value:$,index:1,children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(s,{variant:"h6",fontWeight:"bold",children:"Lab Reservation Management"}),e.jsx(m,{variant:"outlined",startIcon:e.jsx(He,{}),onClick:()=>ut(!ve),children:"Filters"})]}),e.jsxs(v,{sx:{p:2,mb:3},children:[e.jsx(Ye,{placeholder:"Search by lab, user, attendees, or purpose...",variant:"outlined",size:"small",fullWidth:!0,value:G,onChange:t=>Pe(t.target.value),InputProps:{startAdornment:e.jsx(Je,{position:"start",children:e.jsx(Ke,{})})},sx:{mb:ve?2:0}}),ve&&e.jsxs(a,{sx:{mt:2},children:[e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(q,{size:"small",fullWidth:!0,children:[e.jsx(W,{children:"Status"}),e.jsxs(F,{value:Y,label:"Status",onChange:t=>Te(t.target.value),children:[e.jsx(h,{value:"",children:"All Statuses"}),e.jsx(h,{value:"pending",children:"Pending"}),e.jsx(h,{value:"approved",children:"Approved"}),e.jsx(h,{value:"denied",children:"Denied"}),e.jsx(h,{value:"cancelled",children:"Cancelled"}),e.jsx(h,{value:"completed",children:"Completed"})]})]})}),e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(q,{size:"small",fullWidth:!0,children:[e.jsx(W,{children:"Date"}),e.jsxs(F,{value:K,label:"Date",onChange:t=>We(t.target.value),children:[e.jsx(h,{value:"",children:"All Dates"}),e.jsx(h,{value:"today",children:"Today"}),e.jsx(h,{value:"tomorrow",children:"Tomorrow"}),e.jsx(h,{value:"thisWeek",children:"This Week"}),e.jsx(h,{value:"upcoming",children:"All Upcoming"}),e.jsx(h,{value:"past",children:"Past"})]})]})}),e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(q,{size:"small",fullWidth:!0,children:[e.jsx(W,{children:"Laboratory"}),e.jsxs(F,{value:B,label:"Laboratory",onChange:t=>X(t.target.value),children:[e.jsx(h,{value:"",children:"All Laboratories"}),U.map(t=>e.jsx(h,{value:t.id,children:t.name},t.id))]})]})})]}),e.jsx(a,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:e.jsx(m,{variant:"text",color:"secondary",size:"small",onClick:()=>{Pe(""),Te(""),We(""),X("")},children:"Clear Filters"})})]})]}),e.jsx(Xe,{component:v,children:e.jsxs(Ze,{children:[e.jsx(et,{children:e.jsxs(I,{children:[e.jsx(u,{children:"User"}),e.jsx(u,{children:"Lab"}),e.jsx(u,{children:"Start Time"}),e.jsx(u,{children:"End Time"}),e.jsx(u,{children:"Status"}),e.jsx(u,{children:"Actions"})]})}),e.jsx(tt,{children:Qe.length>0?Qe.map(t=>e.jsxs(I,{children:[e.jsx(u,{children:e.jsxs(a,{children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:t.user?.email?.split("@")[0]||"Unknown User"}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[t.user?.department||"Unknown Department"," ",t.user?.role||"Unknown Role"]})]})}),e.jsx(u,{children:e.jsxs(a,{children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:t.lab?.name}),e.jsx(s,{variant:"caption",color:"text.secondary",children:t.lab?.location})]})}),e.jsx(u,{children:b(d(t.start_time),"PPpp")}),e.jsx(u,{children:b(d(t.end_time),"PPpp")}),e.jsx(u,{children:ie(t.status)}),e.jsx(u,{children:e.jsxs(a,{sx:{display:"flex",gap:1},children:[e.jsx(st,{title:"View Details",children:e.jsx(nt,{size:"small",onClick:()=>Lt(t),children:e.jsx(rt,{fontSize:"small"})})}),t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{size:"small",color:"success",variant:"outlined",onClick:()=>A(t,"approve"),startIcon:e.jsx(at,{}),children:"Approve"}),e.jsx(m,{size:"small",color:"error",variant:"outlined",onClick:()=>A(t,"deny"),startIcon:e.jsx(it,{}),children:"Deny"})]})]})})]},t.id)):e.jsx(I,{children:e.jsxs(u,{colSpan:6,align:"center",children:[e.jsx(s,{variant:"subtitle1",sx:{py:2},children:"No lab reservations found"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Try adjusting your search or filter criteria"})]})})})]})}),Ge>1&&e.jsx(a,{sx:{display:"flex",justifyContent:"center",mt:3},children:e.jsx(ot,{count:Ge,page:ze,onChange:At,color:"primary"})})]}),e.jsx(fe,{value:$,index:2,children:e.jsx(v,{sx:{p:2},children:e.jsx(Mt,{plugins:[Nt,Vt,Ot],initialView:"timeGridWeek",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},events:qt,eventClick:Wt,height:"auto",aspectRatio:1.5,slotMinTime:"07:00:00",slotMaxTime:"21:00:00"})})}),e.jsx(fe,{value:$,index:3,children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(N,{children:e.jsxs(V,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,fontWeight:"bold",children:"Equipment Reservation Status Summary"}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"warning.main",children:g.filter(t=>t.status==="pending").length}),e.jsx(s,{variant:"body2",children:"Pending"})]}),e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"success.main",children:g.filter(t=>t.status==="approved").length}),e.jsx(s,{variant:"body2",children:"Approved"})]}),e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"error.main",children:g.filter(t=>t.status==="denied").length}),e.jsx(s,{variant:"body2",children:"Denied"})]}),e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"text.secondary",children:g.filter(t=>t.status==="cancelled").length}),e.jsx(s,{variant:"body2",children:"Cancelled"})]}),e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"text.secondary",children:g.filter(t=>t.status==="completed").length}),e.jsx(s,{variant:"body2",children:"Completed"})]})]}),e.jsx(z,{sx:{my:2}}),e.jsxs(s,{variant:"subtitle1",gutterBottom:!0,children:["Today's Reservations: ",g.filter(t=>{const n=d(t.start_time);return ge(n)}).length]}),e.jsxs(s,{variant:"subtitle1",gutterBottom:!0,children:["Tomorrow's Reservations: ",g.filter(t=>{const n=d(t.start_time);return pe(n)}).length]})]})})}),e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(N,{children:e.jsxs(V,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,fontWeight:"bold",children:"Lab Reservation Status Summary"}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"warning.main",children:f.filter(t=>t.status==="pending").length}),e.jsx(s,{variant:"body2",children:"Pending"})]}),e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"success.main",children:f.filter(t=>t.status==="approved").length}),e.jsx(s,{variant:"body2",children:"Approved"})]}),e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"error.main",children:f.filter(t=>t.status==="denied").length}),e.jsx(s,{variant:"body2",children:"Denied"})]}),e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"text.secondary",children:f.filter(t=>t.status==="cancelled").length}),e.jsx(s,{variant:"body2",children:"Cancelled"})]}),e.jsxs(a,{sx:{textAlign:"center",p:1},children:[e.jsx(s,{variant:"h4",color:"text.secondary",children:f.filter(t=>t.status==="completed").length}),e.jsx(s,{variant:"body2",children:"Complated"})]})]}),e.jsx(z,{sx:{my:2}}),e.jsxs(s,{variant:"subtitle1",gutterBottom:!0,children:["Today's Lab Reservation: ",f.filter(t=>{const n=d(t.start_time);return ge(n)}).length]}),e.jsxs(s,{variant:"subtitle1",gutterBottom:!0,children:["Tomorrow's Reservations: ",f.filter(t=>{const n=d(t.start_time);return pe(n)}).length]})]})})}),e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(N,{children:e.jsxs(V,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,fontWeight:"bold",children:"Recent Pending Equipment Reservations"}),e.jsxs(lt,{children:[g.filter(t=>t.status==="pending").slice(0,5).map((t,n)=>e.jsxs(a,{children:[e.jsxs(a,{sx:{py:1},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:t.equipment?.name}),e.jsx(s,{variant:"caption",color:"text.secondary",children:b(d(t.created_at),"PPp")})]}),e.jsxs(s,{variant:"caption",display:"block",color:"text.secondary",children:["Requested by: ",t.users?.email]}),e.jsxs(s,{variant:"caption",display:"block",color:"text.secondary",children:[b(d(t.start_time),"PPp")," - ",b(d(t.end_time),"p")]}),e.jsxs(a,{sx:{mt:1,display:"flex",gap:1},children:[e.jsx(m,{size:"small",variant:"outlined",color:"success",onClick:()=>P(t,"approve"),children:"Approve"}),e.jsx(m,{size:"small",variant:"outlined",color:"error",onClick:()=>P(t,"deny"),children:"Deny"})]})]}),n<Math.min(g.filter(r=>r.status==="pending").length,5)-1&&e.jsx(z,{})]},t.id)),g.filter(t=>t.status==="pending").length===0&&e.jsx(a,{sx:{py:2,textAlign:"center"},children:e.jsx(s,{variant:"body2",color:"text.secondary",children:"No pending reservations"})})]})]})})}),e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(N,{children:e.jsxs(V,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,fontWeight:"bold",children:"Recent Pending Lab Reservations"}),e.jsxs(lt,{children:[f.filter(t=>t.status==="pending").slice(0,5).map((t,n)=>e.jsxs(a,{children:[e.jsxs(a,{sx:{py:1},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:t.lab?.name}),e.jsx(s,{variant:"caption",color:"text.secondary",children:b(d(t.created_at),"PPp")})]}),e.jsxs(s,{variant:"caption",display:"block",color:"text.secondary",children:["Requested by: ",t.users?.email]}),e.jsxs(s,{variant:"caption",display:"block",color:"text.secondary",children:[b(d(t.start_time),"PPp")," - ",b(d(t.end_time),"p")]}),e.jsxs(a,{sx:{mt:1,display:"flex",gap:1},children:[e.jsx(m,{size:"small",variant:"outlined",color:"success",onClick:()=>A(t,"approve"),children:"Approve"}),e.jsx(m,{size:"small",variant:"outlined",color:"error",onClick:()=>A(t,"deny"),children:"Deny"})]})]}),n<Math.min(O.filter(r=>r.status==="pending").length,5)-1&&e.jsx(z,{})]},t.id)),f.filter(t=>t.status==="pending").length===0&&e.jsx(a,{sx:{py:2,textAlign:"center"},children:e.jsx(s,{variant:"body2",color:"text.secondary",children:"No pending lab reservations"})})]})]})})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(N,{children:e.jsxs(V,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,fontWeight:"bold",children:"Laboratory Utilization"}),e.jsx(p,{container:!0,spacing:2,children:zt.map(t=>e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(v,{variant:"outlined",sx:{p:2},children:[e.jsx(s,{variant:"subtitle1",gutterBottom:!0,children:t.name}),e.jsx(s,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:t.location}),e.jsxs(s,{variant:"body2",children:["Active Reservations: ",t.activeReservations]}),e.jsxs(s,{variant:"body2",children:["Today's Reservations: ",t.todaysReservations]})]})},t.id))})]})})})]})}),e.jsx(ue,{open:xt,onClose:()=>_(!1),maxWidth:"md",fullWidth:!0,children:c&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:"Reservation Details"}),e.jsx(je,{children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsxs(p,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"subtitle1",gutterBottom:!0,fontWeight:"bold",children:"Equipment Information"}),e.jsx(a,{component:"img",src:c.equipment?.image_url||"https://picsum.photos/200/300",alt:c.equipment?.name,sx:{width:"100%",height:200,objectFit:"cover",borderRadius:1,mb:2}}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Name:"})," ",c.equipment?.name]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Category:"})," ",c.equipment?.category]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Manufacturer:"})," ",c.equipment?.manufacturer]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Model:"})," ",c.equipment?.model]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Status:"})," ",c.equipment?.status]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Lab:"}),c.equipment?.lab_id?U.find(t=>t.id===c.equipment.lab_id)?.name||"Unknown Lab":"No Lab Assigned",c.equipment?.lab_id?` (${U.find(t=>t.id===c.equipment.lab_id)?.location||"Unknown Location"})`:""]})]}),e.jsxs(p,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"subtitle1",gutterBottom:!0,fontWeight:"bold",children:"User Information"}),e.jsxs(v,{variant:"outlined",sx:{p:2,mb:3},children:[e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Email:"})," ",c.users?.email]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Department:"})," ",c.users?.department]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Role:"})," ",c.users?.role]})]}),e.jsx(s,{variant:"subtitle1",gutterBottom:!0,fontWeight:"bold",children:"Reservation Information"}),e.jsxs(v,{variant:"outlined",sx:{p:2},children:[e.jsxs(a,{sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(s,{variant:"body2",sx:{mr:1},children:e.jsx("strong",{children:"Status:"})}),ie(c.status)]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Created:"})," ",b(d(c.created_at),"PPpp")]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Start Time:"})," ",b(d(c.start_time),"PPpp")]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"End Time:"})," ",b(d(c.end_time),"PPpp")]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Duration:"}),(()=>{const t=new Date(c.start_time);let r=new Date(c.end_time).getTime()-t.getTime();const j=Math.floor(r/(1e3*60*60));r-=j*(1e3*60*60);const i=Math.floor(r/(1e3*60));return`${j} hour(s), ${i} minute(s)`})()]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Quantity:"})," ",c.quantity]}),e.jsx(z,{sx:{my:2}}),e.jsx(s,{variant:"subtitle2",gutterBottom:!0,children:"Purpose:"}),e.jsx(s,{variant:"body2",children:c.purpose})]})]})]})}),e.jsxs(me,{children:[e.jsx(m,{onClick:()=>_(!1),children:"Close"}),c.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{color:"success",variant:"contained",onClick:()=>P(c,"approve"),disabled:re,children:"Approve"}),e.jsx(m,{color:"error",variant:"contained",onClick:()=>P(c,"deny"),disabled:re,children:"Deny"})]})]})]})}),e.jsx(ue,{open:jt,onClose:()=>_(!1),maxWidth:"md",fullWidth:!0,children:x&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:"Reservation Details"}),e.jsx(je,{children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsxs(p,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"subtitle1",gutterBottom:!0,fontWeight:"bold",children:"Lab Information"}),e.jsx(a,{component:"img",src:x.lab?.image_url||"https://picsum.photos/200/300",alt:x.lab?.name,sx:{width:"100%",height:200,objectFit:"cover",borderRadius:1,mb:2}}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Name:"})," ",x.lab?.name]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Status:"})," ",x.lab?.status]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"location:"}),"  ",x.lab?.location]})]}),e.jsxs(p,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"subtitle1",gutterBottom:!0,fontWeight:"bold",children:"User Information"}),e.jsxs(v,{variant:"outlined",sx:{p:2,mb:3},children:[e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Email:"})," ",x.user?.email]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Department:"})," ",x.user?.department]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Role:"})," ",x.user?.role]})]}),e.jsx(s,{variant:"subtitle1",gutterBottom:!0,fontWeight:"bold",children:"Lab Reservation Information"}),e.jsxs(v,{variant:"outlined",sx:{p:2},children:[e.jsxs(a,{sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(s,{variant:"body2",sx:{mr:1},children:e.jsx("strong",{children:"Status:"})}),ie(x.status)]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Created:"})," ",b(d(x.created_at),"PPpp")]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Start Time:"})," ",b(d(x.start_time),"PPpp")]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"End Time:"})," ",b(d(x.end_time),"PPpp")]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Duration:"}),(()=>{const t=new Date(x.start_time);let r=new Date(x.end_time).getTime()-t.getTime();const j=Math.floor(r/(1e3*60*60));r-=j*(1e3*60*60);const i=Math.floor(r/(1e3*60));return`${j} hour(s), ${i} minute(s)`})()]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Attendees:"})," ",x.attendees]}),e.jsx(z,{sx:{my:2}}),e.jsx(s,{variant:"subtitle2",gutterBottom:!0,children:"Purpose:"}),e.jsx(s,{variant:"body2",children:x.purpose})]})]})]})}),e.jsxs(me,{children:[e.jsx(m,{onClick:()=>Z(!1),children:"Close"}),x.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{color:"success",variant:"contained",onClick:()=>A(x,"approve"),disabled:ae,children:"Approve"}),e.jsx(m,{color:"error",variant:"contained",onClick:()=>A(x,"deny"),disabled:ae,children:"Deny"})]})]})]})}),e.jsxs(ue,{open:mt,onClose:()=>{ee(!1),se(null)},children:[e.jsx(xe,{children:k==="approve"?"Approve Reservation":"Deny Reservation"}),e.jsx(je,{children:e.jsx(dt,{children:k==="approve"?"Are you sure you want to approve this reservation? The equipment will be reserved for the requested time slot.":"Are you sure you want to deny this reservation? The user will be notified that their request was denied."})}),e.jsxs(me,{children:[e.jsx(m,{onClick:()=>{ee(!1),se(null)},children:"Cancel"}),e.jsx(m,{color:k==="approve"?"success":"error",variant:"contained",onClick:()=>{c&&k&&_t(c.id,k==="approve"?"approved":"denied")},disabled:re,children:re?e.jsx(ce,{size:24}):k==="approve"?"Approve":"Deny"})]})]}),e.jsxs(ue,{open:pt,onClose:()=>{te(!1),ne(null)},children:[e.jsx(xe,{children:R==="approve"?"Approve Lab Reservation":"Deny LabReservation"}),e.jsx(je,{children:e.jsx(dt,{children:R==="approve"?"Are you sure you want to approve this lab reservation? The lab will be reserved for the requested time slot.":"Are you sure you want to deny this lab reservation? The user will be notified that their request was denied."})}),e.jsxs(me,{children:[e.jsx(m,{onClick:()=>{te(!1),ne(null)},children:"Cancel"}),e.jsx(m,{color:R==="approve"?"success":"error",variant:"contained",onClick:()=>{x&&R&&kt(x.id,R==="approve"?"approved":"denied")},disabled:ae,children:ae?e.jsx(ce,{size:24}):R==="approve"?"Approve":"Deny"})]})]})]})}export{ns as default};
//# sourceMappingURL=ReservationManagement-DebKDWYO.js.map
